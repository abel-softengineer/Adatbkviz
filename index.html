<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Többválaszos Kvíz</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    .kerdes { margin-bottom: 2rem; }
    .valasz { display: block; margin: 5px 0; }
    .helyes { color: green; }
    .rossz { color: red; }
    .eredmeny { font-weight: bold; margin-top: 0.5rem; }
  </style>
</head>
<body>
  <h1>Adatbázis Kvíz – Többválaszos</h1>
  <div id="kviz"></div>
  <button onclick="ellenoriz()">Ellenőrzés</button>

  <script>
    let kerdesek = [];

    fetch('data.json')
      .then(response => response.json())
      .then(data => {
        kerdesek = data.quiz_questions;
        megjelenitKerdesek();
      });

    function megjelenitKerdesek() {
      const kvizDiv = document.getElementById('kviz');
      kvizDiv.innerHTML = '';

      kerdesek.forEach((kerdesObj, index) => {
        const kerdesDiv = document.createElement('div');
        kerdesDiv.classList.add('kerdes');
        kerdesDiv.id = 'kerdes' + index;

        const kerdesCim = document.createElement('p');
        kerdesCim.textContent = (index + 1) + '. ' + kerdesObj.question;
        kerdesDiv.appendChild(kerdesCim);

        kerdesObj.options.forEach((valasz, valaszIndex) => {
          const label = document.createElement('label');
          label.classList.add('valasz');

          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.name = 'kerdes' + index;
          checkbox.value = valaszIndex;

          label.appendChild(checkbox);
          label.appendChild(document.createTextNode(' ' + valasz));
          kerdesDiv.appendChild(label);
        });

        // Hely a visszajelzésnek
        const eredmeny = document.createElement('div');
        eredmeny.classList.add('eredmeny');
        eredmeny.id = 'eredmeny' + index;
        kerdesDiv.appendChild(eredmeny);

        kvizDiv.appendChild(kerdesDiv);
      });
    }

    function ellenoriz() {
      kerdesek.forEach((kerdesObj, index) => {
        const valaszok = document.querySelectorAll(`input[name="kerdes${index}"]`);
        const helyes = new Set(kerdesObj.correct_answers);
        const kijeloltek = new Set();
        const eredmenyElem = document.getElementById('eredmeny' + index);

        let hibasValasztas = false;

        valaszok.forEach(input => {
          const valaszIndex = parseInt(input.value);
          const label = input.parentElement;
          label.classList.remove('helyes', 'rossz');

          if (input.checked) {
            kijeloltek.add(valaszIndex);
            if (helyes.has(valaszIndex)) {
              label.classList.add('helyes');
            } else {
              label.classList.add('rossz');
              hibasValasztas = true;
            }
          } else {
            if (helyes.has(valaszIndex)) {
              label.classList.add('rossz');
              hibasValasztas = true;
            }
          }
        });

        // Számoljuk a helyes kijelölések számát
        const helyesSzam = Array.from(kijeloltek).filter(i => helyes.has(i)).length;
        const teljesenHelyes = helyesSzam === helyes.size && kijeloltek.size === helyes.size && !hibasValasztas;

        if (teljesenHelyes) {
          eredmenyElem.textContent = "✅ Helyes megoldás!";
          eredmenyElem.style.color = "green";
        } else {
          eredmenyElem.textContent = `❌ ${helyesSzam}/${helyes.size} helyes választ jelöltél meg.`;
          eredmenyElem.style.color = "red";
        }
      });
    }
  </script>
</body>
</html>
